<app-header-breadcrumb></app-header-breadcrumb>
<div [class.hidden]="!showLoaderDialogTratar" class="np-loader">
  <p-progressSpinner strokeWidth="5"></p-progressSpinner>
</div>
<form #f="ngForm" autocomplete="off">
<p-panel header="Encaminhamentos a Tratar">
<p-card>
  <div class="p-col-12">
    <label>Protocolo ano: </label>
    <p-dropdown inputId="anosssss" [options]="anos" name="anosssss"  [(ngModel)]="ano" 
      #anosssss="ngModel">
    </p-dropdown>
    <button pButton type="button" style="height: 33px;" (click)="listaTratar()"
    label="Pesquisar"></button>
</div>
<br>  
  <div class="p-fluid p-formgrid p-grid">

  




    <p-table [value]="dados"   styleClass="p-datatable-sm p-datatable-striped" sortField="area" sortMode="single" [scrollable]="true">
    <ng-template pTemplate="header">
        <tr>
            <th style="width:100px;">Protocolo</th>
            <th style="width:200px;">Assunto</th>
            <th style="width:100px;text-align: center;">Prioridade</th>
            <th style="width:100px; text-align: center;">Data Encaminhamento</th>
            <th style="width:100px; text-align: center;">Data Prazo</th>
            <th style="width:100px; text-align: center;">Dias Vencido</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-atendimento let-rowIndex="rowIndex">
        <tr [style]="atendimento.prazoVencido === 'S' ?
        'background-color:Pink;' : ''">
        <td style="width:100px;">
          <a (click)="showAtendimento(atendimento.codigoEncaminhamento)"><u>
          {{atendimento.protocolo}}</u>
          </a>
        </td>
        <td style="width:200px"> 
          {{atendimento.assunto}}
        </td>
        <td style="width:100px; text-align: center;"> 
            {{atendimento.prioridade}}
          </td>        
        <td  style="width:100px; text-align: center;">
            {{atendimento.data}}
          </td>
        <td style="width:100px; text-align: center;">
          {{atendimento.dataPrazo}}
        </td>
        <td style="width:100px; text-align: center;"> 
            {{atendimento.diasVencido}}
          </td>        
      </tr>
  </ng-template>
</p-table>
  </div>
  <br>
<div class="p-fluid p-formgrid p-grid">
    <div class="p-field p-col-2">
      <button pButton type="button"
      icon="pi pi-file-excel"
      iconPos="left"
      label="Excel"
      (click)="exportAsXLSX()"
      [disabled]="f.invalid || dados.length === 0"></button>
    </div>
  </div>
</p-card>
</p-panel>
</form>
